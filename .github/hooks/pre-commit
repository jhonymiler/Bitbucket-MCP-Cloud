#!/bin/bash
# Pre-commit hook para verificar vazamentos de seguran√ßa

echo "üîç Verificando seguran√ßa antes do commit..."

# Verificar se arquivos .env est√£o sendo commitados
if git diff --cached --name-only | grep -E "\.env$|\.env\..*$"; then
    echo "‚ùå ERRO: Arquivo .env detectado no commit!"
    echo "   Arquivos .env cont√™m informa√ß√µes sens√≠veis e n√£o devem ser commitados."
    echo "   Use .env.example para templates."
    exit 1
fi

# Verificar por poss√≠veis tokens ou senhas
if git diff --cached | grep -E "(password|token|secret|key).*=.*[A-Za-z0-9]{10,}"; then
    echo "‚ùå ERRO: Poss√≠vel credencial detectada no commit!"
    echo "   Verifique se n√£o h√° senhas, tokens ou chaves sendo commitadas."
    exit 1
fi

# Verificar por URLs com credenciais
if git diff --cached | grep -E "https?://[^:]+:[^@]+@"; then
    echo "‚ùå ERRO: URL com credenciais detectada!"
    exit 1
fi

echo "‚úÖ Verifica√ß√£o de seguran√ßa passou!"
exit 0
